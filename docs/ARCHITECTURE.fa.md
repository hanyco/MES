# مستند معماری پروژه MES Code Generator

## 🧭 مقدمه
این مستند با هدف تشریح ساختار معماری پروژه MES Code Generator تهیه شده و شامل دو بخش اصلی است:
1. خود ابزار تولیدکننده کد (Code Generator - CG)
2. پروژه خروجی تولید شده (MES)

---

## 🧩 معماری کلی پروژه

### Code Generator (CG)
- این بخش یک ابزار WPF برای تولید خودکار کد است.
- معماری آن ساده و سرویس‌محور طراحی شده است.
- فاقد CQRS و MediatR بوده و هر ماژول صرفاً شامل یک Service واحد است.
- سرویس‌ها هم عملیات CRUD و هم تولید کد را پوشش می‌دهند.
- از DI (Dependency Injection) و Interface استفاده نمی‌شود؛ نمونه‌ها مستقیماً ایجاد می‌شوند.

### MES (Generated Project)
- پروژه خروجی با معماری کامل CQRS تولید می‌شود.
- از MediatR و Dapper استفاده می‌کند.
- هر لایه (Application، API، UI) به‌صورت ماژولار و مبتنی بر namespace پیاده‌سازی می‌شود.
- هیچ لایه Repository نباید در این پروژه وجود داشته باشد.

---

## 🧱 ساختار لایه‌ها

### در CG:
- Application Services: کلاس‌های ساده برای CRUD و تولید کد
- UI (WPF): ViewModelها مستقیماً سرویس‌ها را new می‌کنند و از آن‌ها استفاده می‌کنند.
- CodeGenLib: موتور تولید کد مبتنی بر Roslyn

### در MES:
- DTO: مدل‌های داده
- CQRS: شامل Command/Query/Handler
- API: کنترلرهایی که از MediatR استفاده می‌کنند
- Blazor UI: فرم‌های List و Detail
- هیچ استفاده‌ای از Repository یا Interface در خروجی مجاز نیست.

---

## 🧠 Functionality چیست؟
Functionality به معنای تولید کامل یک مسیر پردازش Request/Response است که شامل:
- DTO
- CQRS (Command, Query, Handler)
- API Controller
- UI (Blazor)

با انتخاب یک جدول یا DTO، این بخش‌ها به‌صورت یکپارچه تولید می‌شوند.

---

## 📥 Metadata و ذخیره‌سازی
تمام اطلاعات مربوط به کد تولید شده به‌عنوان Metadata در دیتابیس ذخیره می‌شود تا قابلیت بازتولید دقیق کد بدون نیاز به ورودی مجدد وجود داشته باشد.

---

## 🧭 نقش ماژول‌ها و namespace
هر کد تولید شده باید در یک ماژول قرار گیرد.
نام ماژول در ساختار پوشه‌ای و namespace اعمال می‌شود.

---

## 🔐 ملاحظات امنیتی
امنیت بر اساس Claim و JWT طراحی شده ولی پیاده‌سازی آن در فاز نهایی پروژه انجام خواهد شد.
سیستم باید از ابتدا قابلیت پذیرش ویژگی‌های امنیتی در خروجی‌ها را داشته باشد.